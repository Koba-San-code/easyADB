## ADB Simple Tool – Документация

Минимальный консольный инструмент для повседневной работы с устройствами Android через ADB + (опционально) scrcpy. Теперь включает панель управления пакетами с БД состояний и undo.

### Состав
- `adb_tool_simple.bat` – основной скрипт.
- `adb.exe` (если присутствует локально; иначе используется системный adb из PATH).
- `scrcpy/` (опционально portable scrcpy; fallback на глобальный `scrcpy`).
- `adb_simple.log` – лог операций.
- `Packages_states.txt` – «БД» пакетов: `имя|status|type`.
- `packages_stack.txt` – стек undo (последовательность изменений статусов).
- Папка `screens/` – скриншоты и записи экрана.

### Главное меню (актуально)
1. Refresh / Pick device – выбрать первое доступное устройство.
2. Install ALL APK – установка всех `*.apk` в текущей папке.
3. Install ONE APK – установка одного APK.
4. Package manager – вход в панель управления пакетами.
5. Push / Pull – передача файлов/папок с логом OK/FAIL.
6. Screenshot – снимок экрана.
7. Screenrecord – запись экрана (до 180 сек).
8. Reboot menu – reboot / recovery / bootloader.
9. Grant permission – `pm grant`.
10. Revoke permission – `pm revoke`.
11. Wireless ADB – tcpip 5555 / connect / auto-detect IP / disconnect.
12. Device info – SDK + root check.
13. Cleanup temp – удаляет `/data/local/tmp/shot.png` & `rec.mp4`.
14. Screen stream – scrcpy (с попыткой `--audio`).
0. Exit – выход.

### Панель Package Manager
Вызов пункт 4.
Подменю:
1) Show packages – вывод с фильтрами:
	- Substring filter (по подстроке в имени)
	- Status filter: enabled / disabled / deleted / any
	- Type filter: system / user / other / any (тип формируется по `pm list packages -s` / `-3`)
	Показываются счётчики: total, enabled, disabled, deleted.
2) Disable package – по номеру (из текущего отображения) или точному имени.
3) Enable package – аналогично.
4) Uninstall package – меняет статус в БД на deleted (имя остаётся в списке).
5) Refresh statuses – полное пересканирование; обновляет statuses и types, добавляет новые пакеты, помечает отсутствующие как deleted.
6) Export list – формирует `packages_export_<status>.txt` по выбранному статусу.
7) Mass disable – из файла (1 имя на строку) или inline список (разделители пробел/запятая).
8) Mass enable – аналогично disable.
9) Undo last change – откат последнего действия (enable/disable статус возвращается; uninstall только помечает обратно предыдущий статус без реинсталляции APK).
0) Back – назад в главное меню.

### Формат БД пакетов
`Packages_states.txt` строки вида:
```
package.name|enabled|system
package.name2|disabled|user
package.removed|deleted|other
```
Статусы: enabled / disabled / deleted.
Типы: system / user / other.

### Undo стек
`packages_stack.txt` строки:
```
package.name|previous_status|new_status|action
```
`undo` снимает последнюю строку и пытается обратное действие (enable<->disable). Для uninstall только восстанавливает статус в БД (физическую установку надо выполнить вручную).

### Логирование
Файл: `adb_simple.log`.
Основные токены: script_entry, started, exit, selected=SERIAL, no_device, OK/FAIL install, OK/FAIL uninstall, push_OK / push_FAIL / pull_OK / pull_FAIL, screenshot, screenrecord, cleanup_tmp, scrcpy_exit, packages_refreshed, disable_OK / disable_FAIL, enable_OK / enable_FAIL, uninstall_OK / uninstall_FAIL, export_<status>, undo.
Формат строки:
```
[DD.MM.YYYY HH:MM:SS,ms] token ...
```

### Архитектура
Один .bat файл, функции через метки + `call`. Точка входа `:__start` прыжком через определения. `ADB_CMD` формируется после выбора устройства (или равен `adb`). Работа с пакетами использует временные .tmp файлы и сортировку `sort`.

### Особенности
- Временные файлы на устройстве: `/data/local/tmp/shot.png`, `/data/local/tmp/rec.mp4`.
- При отсутствии устройства большинство операций просто не выполнятся — сначала пункт 1.
- Для массовых списков можно смешивать пробелы и запятые.
- Пайпы в выводе списка экранированы (`^|`).
- Статус deleted не удаляет строку из БД, служит для аудита.

### scrcpy
Поиск: локальный `scrcpy\scrcpy.exe` затем глобальный `scrcpy`. Сначала пробует `--audio`, иначе повтор без аудио. Для кастомизации флагов редактируйте метку `:scrcpy_stream`.

### Типичные сценарии
1. Массовое отключение ненужных системных пакетов: Refresh → Show (filter system) → Export disabled → Mass disable.
2. Анализ новых пакетов после обновления прошивки: Refresh → Show (filter any) → сравнить по добавленным строкам.
3. Быстрая запись и скриншоты: пункты 6–7.
4. Undo ошибочного disable: Undo last change.

### Ограничения
- Нет автоматического восстановления (reinstall) после uninstall (только статус возвращается).
- Не поддерживаются split-APK / .apks архивы.
- Undo хранит только последовательно накопленный стек; после выхода стек не очищается (можно вручную очистить файл).

### Расширение / кастомизация
Добавление новой функции: создать метку `:my_action`, вызвать её из цепочки if в `:main_menu`, добавить лог и (при необходимости) обновить документацию.

### Устранение неполадок
- Пустое окно / мгновенный выход: проверь `goto :__start` после инициализации.
- adb не найден: положите `adb.exe` рядом или добавьте в PATH.
- Нет пакетов / пустой список: проверьте соединение (`adb devices`), затем Refresh statuses.
- scrcpy не запускается: протестируйте `scrcpy --version` в отдельном окне.

### Быстрый старт
1. Подключите устройство и подтвердите RSA.
2. Запустите `adb_tool_simple.bat`.
3. Пункт 1 (Refresh) — увидеть serial.
4. Пункт 4 (Package manager) → 5 (Refresh statuses) для построения БД.
5. Используйте нужные операции.

## Подробное руководство по использованию

### Подготовка к работе

#### Шаг 1: Настройка Android устройства
1. **Включите режим разработчика:**
   - Перейдите в "Настройки" → "О телефоне"
   - Нажмите 7 раз на "Номер сборки" или "Build number"
   - Появится сообщение "Вы стали разработчиком"

2. **Включите отладку по USB:**
   - Вернитесь в "Настройки" → "Система" → "Параметры разработчика"
   - Включите "Отладка по USB" (USB debugging)
   - Рекомендуется также включить "Установка приложений через USB"

3. **Подключите устройство:**
   - Используйте качественный USB кабель (не только для зарядки)
   - При первом подключении появится диалог подтверждения RSA ключа
   - Обязательно поставьте галочку "Всегда разрешать с этого компьютера" и нажмите "OK"

#### Шаг 2: Проверка ADB соединения
```batch
# Запустите adb_tool_simple.bat
# Выберите пункт 1 (Refresh / Pick device)
```
**Что происходит:** Скрипт выполняет `adb devices` и показывает список подключенных устройств. Если устройство показывается как "unauthorized", повторите шаг с подтверждением RSA.

**Ожидаемый результат:**
```
Выбранное устройство: ABC123DEF456 (где ABC123DEF456 - серийный номер вашего устройства)
```

### Работа с APK файлами

#### Установка одного APK
**Сценарий:** У вас есть APK файл, который нужно установить на устройство.

1. Поместите APK файл в папку со скриптом
2. Запустите скрипт → Пункт 3 (Install ONE APK)
3. Введите имя файла (например: `myapp.apk`) или полный путь
4. Дождитесь завершения установки

**Пример лога:**
```
[13.08.2025 21:30:15,123] install_OK myapp.apk
```

#### Массовая установка APK
**Сценарий:** У вас есть папка с несколькими APK файлами для установки.

1. Поместите все APK файлы в папку со скриптом
2. Пункт 2 (Install ALL APK)
3. Скрипт автоматически найдет все *.apk файлы и установит их по очереди

**Что происходит:** Скрипт выполняет `dir /b *.apk` и для каждого найденного файла вызывает `adb install -r "filename.apk"`. Флаг `-r` позволяет переустанавливать существующие приложения.

### Управление пакетами приложений

#### Первоначальная настройка Package Manager
**Обязательно выполните при первом использовании:**

1. Пункт 4 (Package manager)
2. Пункт 5 (Refresh statuses)

**Что происходит:** Скрипт сканирует все установленные пакеты и создает базу данных `Packages_states.txt`. Это может занять 10-30 секунд в зависимости от количества приложений.

#### Просмотр установленных приложений
**Пункт 1 (Show packages)** - самая используемая функция для анализа приложений.

**Фильтрация по типу:**
- `system` - системные приложения (предустановленные)
- `user` - пользовательские приложения (установленные вами)
- `other` - прочие (редко используется)
- `any` - все приложения

**Фильтрация по статусу:**
- `enabled` - активные приложения
- `disabled` - отключенные приложения
- `deleted` - удаленные приложения (остаются в БД для аудита)
- `any` - все статусы

**Фильтрация по подстроке:** Введите часть имени пакета для поиска.

**Практический пример:**
```
Фильтр подстроки: google
Фильтр статуса: enabled
Фильтр типа: system
```
Покажет все активные системные приложения Google.

#### Отключение ненужных приложений

**Способ 1: По номеру из списка**
1. Show packages → найдите приложение в списке
2. Запомните его номер (например, 15)
3. Disable package → введите номер 15

**Способ 2: По точному имени**
1. Disable package → введите полное имя пакета
2. Пример: `com.facebook.system`

**Важно:** Отключение изменяет только статус в системе Android (`pm disable`). Приложение остается установленным, но не запускается и не обновляется.

#### Массовое отключение приложений

**Из файла:**
1. Создайте текстовый файл со списком пакетов (по одному на строку)
2. Mass disable → введите путь к файлу
3. Пример файла `disable_list.txt`:
```
com.facebook.appmanager
com.facebook.system
com.facebook.services
```

**Встроенный список:**
1. Mass disable → выберите inline ввод
2. Введите пакеты через пробел или запятую:
```
com.facebook.appmanager com.facebook.system, com.facebook.services
```

#### Экспорт списков для анализа
**Сценарий:** Нужно создать резервную копию состояния приложений или поделиться списком.

1. Export list → выберите статус (enabled/disabled/deleted/any)
2. Создается файл `packages_export_enabled.txt` со списком

**Содержимое файла:**
```
com.android.chrome
com.google.android.gms
com.whatsapp
...
```

#### Функция отмены (Undo)
**Когда использовать:** Случайно отключили важное приложение или хотите вернуть последнее изменение.

1. Undo last change
2. Скрипт автоматически определит последнее действие и выполнит обратную операцию

**Ограничения:** 
- Для uninstall восстанавливается только статус в БД (физическую установку нужно делать вручную)
- Отменяется только последняя операция

### Передача файлов

#### Push (отправка файлов на устройство)
**Сценарий:** Нужно скопировать файл с компьютера на телефон.

1. Пункт 5 (Push / Pull)
2. Выберите Push
3. Введите локальный путь: `C:\Users\User\Desktop\photo.jpg`
4. Введите путь на устройстве: `/sdcard/Download/photo.jpg`

**Для папок:** Добавьте флаг для рекурсивного копирования
```
Локальный путь: C:\MyFolder
Путь на устройстве: /sdcard/MyFolder
```

#### Pull (получение файлов с устройства)
**Сценарий:** Нужно скопировать файл с телефона на компьютер.

1. Push / Pull → Pull
2. Путь на устройстве: `/sdcard/Download/document.pdf`
3. Локальный путь: `C:\Downloads\document.pdf`

**Популярные пути на Android:**
- `/sdcard/Download/` - папка загрузок
- `/sdcard/DCIM/Camera/` - фотографии камеры
- `/sdcard/Pictures/` - изображения
- `/sdcard/Documents/` - документы

### Работа со скриншотами и записью экрана

#### Создание скриншотов
1. Пункт 6 (Screenshot)
2. Файл автоматически сохраняется в папку `screens/` с именем `screenshot_YYYY-MM-DD_HH-MM-SS.png`

**Техническая реализация:**
```batch
adb shell screencap -p /data/local/tmp/shot.png
adb pull /data/local/tmp/shot.png screens/screenshot_timestamp.png
adb shell rm /data/local/tmp/shot.png
```

#### Запись экрана
1. Пункт 7 (Screenrecord)
2. Введите время записи (максимум 180 секунд)
3. Запись начнется автоматически
4. Файл сохранится в `screens/` как `screenrec_YYYY-MM-DD_HH-MM-SS.mp4`

**Во время записи:** Используйте устройство как обычно. Записывается все, что происходит на экране.

### Управление устройством

#### Перезагрузка устройства
**Пункт 8 (Reboot menu)** предоставляет три варианта:

1. **Normal reboot** - обычная перезагрузка
2. **Recovery mode** - загрузка в режим восстановления (для установки обновлений)
3. **Bootloader** - загрузка в fastboot режим (для прошивки)

**Внимание:** Recovery и Bootloader режимы предназначены для опытных пользователей.

#### Управление разрешениями
**Предоставление разрешений (Grant):**
1. Пункт 9 (Grant permission)
2. Введите имя пакета: `com.example.app`
3. Введите разрешение: `android.permission.CAMERA`

**Отзыв разрешений (Revoke):**
1. Пункт 10 (Revoke permission)
2. Аналогично grant, но отбирает разрешение

**Популярные разрешения:**
- `android.permission.CAMERA` - камера
- `android.permission.RECORD_AUDIO` - микрофон
- `android.permission.ACCESS_FINE_LOCATION` - местоположение
- `android.permission.READ_EXTERNAL_STORAGE` - чтение файлов
- `android.permission.WRITE_EXTERNAL_STORAGE` - запись файлов

### Беспроводное подключение (Wireless ADB)

#### Настройка Wi-Fi ADB
**Требования:** Устройство и компьютер должны быть в одной Wi-Fi сети.

1. **Первоначальная настройка (с USB кабелем):**
   - Подключите устройство через USB
   - Пункт 11 (Wireless ADB)
   - Выберите опцию включения tcpip режима
   - Устройство перейдет в режим Wi-Fi ADB на порту 5555

2. **Подключение по Wi-Fi:**
   - Отключите USB кабель
   - В меню Wireless ADB выберите подключение
   - Скрипт автоматически определит IP адрес устройства
   - Если автоопределение не сработало, введите IP вручную

3. **Отключение Wi-Fi режима:**
   - Выберите disconnect для возврата к USB режиму

**Преимущества Wi-Fi ADB:** Работа без кабеля, удобство при тестировании приложений.

### Использование scrcpy для трансляции экрана

#### Запуск scrcpy
1. Пункт 14 (Screen stream)
2. Скрипт автоматически:
   - Проверяет наличие scrcpy в папке `scrcpy/`
   - Если не найден, использует глобальную установку
   - Пробует запуск с аудио (`--audio`)
   - При ошибке повторяет без аудио

**Возможности scrcpy:**
- Отображение экрана устройства в реальном времени
- Управление устройством через мышь и клавиатуру
- Передача аудио (при поддержке)
- Запись видео прямо в scrcpy

#### Кастомизация scrcpy
Для изменения параметров запуска отредактируйте функцию `:scrcpy_stream` в скрипте:

```batch
# Примеры полезных флагов:
--max-size 1024          # ограничение разрешения
--bit-rate 2M            # битрейт видео
--crop 1224:1440:0:0     # обрезка экрана
--lock-video-orientation # блокировка поворота
```

### Служебные функции

#### Информация об устройстве
**Пункт 12 (Device info)** показывает:
- Версию Android SDK
- Наличие root доступа
- Модель устройства
- Дополнительную системную информацию

#### Очистка временных файлов
**Пункт 13 (Cleanup temp)** удаляет:
- `/data/local/tmp/shot.png` - временный скриншот
- `/data/local/tmp/rec.mp4` - временная запись экрана

**Когда использовать:** При нехватке места на устройстве или после множественных операций со скриншотами.

### Мониторинг и логирование

#### Анализ логов
Файл `adb_simple.log` содержит историю всех операций:

```
[13.08.2025 21:30:15,123] script_entry
[13.08.2025 21:30:16,456] selected=ABC123DEF456
[13.08.2025 21:30:45,789] install_OK myapp.apk
[13.08.2025 21:31:12,321] disable_OK com.facebook.system
[13.08.2025 21:31:30,654] screenshot
```

**Поиск ошибок:** Ищите токены `_FAIL` для диагностики проблем.

#### Резервное копирование состояния
**Важные файлы для сохранения:**
- `Packages_states.txt` - текущее состояние всех пакетов
- `packages_stack.txt` - история изменений для undo
- `adb_simple.log` - полный лог операций

**Восстановление:** Скопируйте эти файлы в новую установку скрипта для сохранения истории.

### Практические сценарии использования

#### Сценарий 1: Оптимизация нового Android устройства
1. **Анализ предустановленных приложений:**
   ```
   Package manager → Refresh statuses
   Show packages → type: system, status: enabled
   Export list → enabled (для резервной копии)
   ```

2. **Отключение ненужного ПО:**
   ```
   Show packages → substring: "facebook"
   Mass disable → список Facebook приложений
   Show packages → substring: "google" → выборочное отключение
   ```

3. **Проверка результата:**
   ```
   Show packages → status: disabled
   Export list → disabled (для документирования)
   ```

#### Сценарий 2: Подготовка устройства для тестирования приложений
1. **Настройка среды:**
   ```
   Wireless ADB → включить tcpip режим
   Отключить USB, работать по Wi-Fi
   Screen stream → запустить scrcpy для мониторинга
   ```

2. **Установка тестового APK:**
   ```
   Install ONE APK → test_app_v1.0.apk
   Screenshot → до тестирования
   ```

3. **Документирование тестов:**
   ```
   Screenrecord → запись процесса тестирования
   Push/Pull → обмен тестовыми данными
   Screenshot → после тестирования
   ```

#### Сценарий 3: Восстановление после неудачных изменений
1. **Быстрая отмена:**
   ```
   Package manager → Undo last change
   ```

2. **Массовое восстановление:**
   ```
   Mass enable → из ранее экспортированного списка enabled
   Refresh statuses → проверка состояния
   ```

3. **Анализ проблем:**
   ```
   Device info → проверка системы
   Просмотр adb_simple.log → поиск ошибок
   ```

### Советы по безопасности

#### Что можно отключать безопасно:
- Приложения социальных сетей (Facebook, Twitter)
- Игры и развлекательные приложения
- Дублирующие приложения (несколько браузеров)
- Приложения операторов связи (если не используются)

#### Что НЕ стоит отключать:
- `com.android.systemui` - системный интерфейс
- `com.google.android.gms` - Google Play Services
- `com.android.phone` - телефонные функции
- `com.android.settings` - настройки системы

#### Меры предосторожности:
- Всегда создавайте Export list перед массовыми изменениями
- Тестируйте отключение по одному приложению
- Держите под рукой список критически важных пакетов
- Используйте Undo для быстрого восстановления

### Оптимизация производительности

#### Ускорение работы с большим количеством пакетов:
1. Используйте фильтры для сужения списков
2. Экспортируйте часто используемые списки в файлы
3. Применяйте массовые операции вместо одиночных

#### Организация рабочего процесса:
1. Создайте папки для разных проектов с соответствующими APK
2. Ведите документацию изменений через Export lists
3. Регулярно делайте Refresh statuses после системных обновлений

### Лицензия / использование
Скрипт предоставляется «как есть». Используйте на свой риск. ADB и scrcpy имеют собственные лицензии.

## Дополнительные возможности и расширения

### Создание пользовательских скриптов
Для автоматизации повторяющихся задач можно создать batch файлы, которые используют функционал ADB Simple Tool:

**Пример автоматической настройки устройства (`auto_setup.bat`):**
```batch
@echo off
echo Автоматическая настройка Android устройства...

REM Создание списка нежелательных пакетов
echo com.facebook.appmanager > unwanted_packages.txt
echo com.facebook.system >> unwanted_packages.txt
echo com.facebook.services >> unwanted_packages.txt

echo Список нежелательных пакетов создан
echo Запустите ADB Simple Tool и выполните:
echo 1. Package manager
echo 2. Mass disable
echo 3. Выберите файл: unwanted_packages.txt
pause
```

### Интеграция с другими инструментами

#### Использование с Android Studio
1. Настройте Wireless ADB для беспроводной разработки
2. Используйте Screen stream для демонстрации приложений
3. Применяйте Package manager для тестирования на "чистых" устройствах

#### Совместимость с другими ADB инструментами
ADB Simple Tool корректно работает параллельно с:
- Android Studio ADB
- Scrcpy (прямой запуск)
- Другими ADB утилитами

**Внимание:** Избегайте одновременного использования нескольких ADB серверов на разных портах.

### Продвинутые техники

#### Создание профилей устройств
Для разных типов устройств (рабочие, игровые, тестовые) создавайте отдельные наборы файлов:

```
profiles/
├── gaming_device/
│   ├── packages_to_disable.txt
│   └── packages_to_enable.txt
├── work_device/
│   ├── packages_to_disable.txt
│   └── packages_to_enable.txt
└── test_device/
    ├── packages_to_disable.txt
    └── packages_to_enable.txt
```

#### Автоматизация через планировщик задач
Создайте задачи Windows для регулярного:
- Создания скриншотов устройства
- Экспорта списков пакетов для мониторинга изменений
- Очистки временных файлов

### Диагностика и решение проблем

#### Типичные ошибки и их решения

**Ошибка: "device unauthorized"**
- Причина: Не подтвержден RSA ключ
- Решение: Переподключите устройство, подтвердите диалог на экране

**Ошибка: "no devices/emulators found"**
- Причина: Устройство не подключено или отключена отладка USB
- Решение: Проверьте подключение, настройки разработчика

**Ошибка: "Installation failed: INSTALL_FAILED_INSUFFICIENT_STORAGE"**
- Причина: Недостаточно места на устройстве
- Решение: Освободите место или используйте Cleanup temp

**Ошибка: "Permission denial" при push/pull**
- Причина: Нет доступа к указанной папке
- Решение: Используйте /sdcard/ вместо внутренних системных папок

**Ошибка: scrcpy не запускается**
- Причина: Отсутствует scrcpy или неправильная версия
- Решение: Скачайте последнюю версию с https://github.com/Genymobile/scrcpy

#### Режим отладки для разработчиков
Для углубленной диагностики добавьте в начало скрипта:
```batch
set DEBUG=1
```
Это включит дополнительное логирование всех ADB команд.

### Безопасность и рекомендации

#### Рекомендации по безопасности данных
1. **Не используйте на корпоративных устройствах** без разрешения IT отдела
2. **Создавайте резервные копии** перед массовыми изменениями
3. **Тестируйте на второстепенных устройствах** перед применением на основном
4. **Документируйте все изменения** через Export lists

#### Соблюдение приватности
- При работе с чужими устройствами получайте явное разрешение
- Не сохраняйте скриншоты/записи без согласия пользователя
- Очищайте логи при передаче скрипта другим пользователям

### Часто задаваемые вопросы (FAQ)

**В: Можно ли использовать скрипт на нескольких устройствах одновременно?**
О: Скрипт работает с одним устройством за раз. Для нескольких устройств запускайте отдельные экземпляры скрипта в разных папках.

**В: Сохраняются ли настройки после перезагрузки устройства?**
О: Да, отключенные пакеты остаются отключенными. Временные файлы (/data/local/tmp/) могут очищаться системой.

**В: Можно ли восстановить удаленное через Uninstall приложение?**
О: Uninstall только помечает пакет как deleted в базе данных. Для восстановления нужно переустановить APK файл.

**В: Работает ли скрипт с эмуляторами Android?**
О: Да, скрипт совместим с Android эмуляторами (Android Studio AVD, Bluestacks и др.).

**В: Можно ли изменить папку для скриншотов?**
О: Да, отредактируйте переменную SCREEN_DIR в начале скрипта.

### Командная строка для продвинутых пользователей

Для интеграции в собственные скрипты можно использовать прямые ADB команды:

```batch
REM Получение списка пакетов
adb shell pm list packages

REM Отключение пакета
adb shell pm disable-user --user 0 com.example.package

REM Включение пакета  
adb shell pm enable com.example.package

REM Проверка статуса пакета
adb shell pm list packages -d | findstr "com.example.package"

REM Создание скриншота
adb shell screencap -p /sdcard/screenshot.png
adb pull /sdcard/screenshot.png
adb shell rm /sdcard/screenshot.png
```

### Мониторинг изменений в системе

#### Отслеживание новых приложений
Регулярно выполняйте Export list и сравнивайте файлы для обнаружения:
- Новых установленных приложений
- Изменений статусов пакетов
- Потенциально нежелательного ПО

#### Создание отчетов о состоянии системы
```batch
REM Создание полного отчета
echo === ОТЧЕТ О СОСТОЯНИИ УСТРОЙСТВА === > device_report.txt
echo Дата: %date% %time% >> device_report.txt
adb get-serialno >> device_report.txt
adb shell getprop ro.build.version.release >> device_report.txt
echo === ОТКЛЮЧЕННЫЕ ПАКЕТЫ === >> device_report.txt
type packages_export_disabled.txt >> device_report.txt
```

---
Если нужна дополнительная автоматизация (например, пакетный reinstall из каталога или метки для групп), можно расширить архитектуру — напишите запрос.
